<div class="container-fluid">
  <app-page-header
    [title]="data.title"
    [subtitle]="data.subtitle"
    [name]="data.name"
  ></app-page-header>
  
  <div class="row mb-5">
    <div class="col-12">

      <div class="card-box">
        
        <h3 class="text-center mb-3">
          Lista de Roles con sus Permisos
        </h3>
        
        <div class="table-responsive">
          <table
            id="table-roles"
            class="table table-bordered table-hover mb-0 dts"
          >
            <thead class="bg-dark text-center text-white text-nowrap">
              <tr style="cursor: pointer">
                <th scope="col">Id</th>
                <th scope="col">Rol</th>
                <th scope="col">Permisos</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngFor="
                  let rol of roles
                  let i = index
                "
                class="text-nowrap text-center"
              >
                <th scope="row" class="align-middle" style="min-width: 80px">
                  {{ rol.iD_Rol }}
                </th>
                <td class="align-middle">{{ rol.nombre_Rol }}</td>
                <td class="align-middle text-wrap">
                  <div class="d-flex flex-wrap justify-content-center">
                    <ng-container *ngIf="rol.rolPermisos && rol.rolPermisos.length > 0; else noPermisos">
                      <span *ngFor="let permiso of rol.rolPermisos"
                            class="px-3 py-1 mr-1 mb-1 bg-dark text-white rounded shadow-sm text-sm">
                        {{ permiso.nombrePermiso }}
                      </span>
                    </ng-container>
                    <ng-template #noPermisos>
                      <span class="text-muted">No tiene permisos asignados</span>
                    </ng-template>
                  </div>
                </td>
                <td class="align-middle text-nowrap" style="min-width: 170px">
                  <div class="d-flex justify-content-center">
                    <button
                      title="Asignar permisos"
                      class="btn btn-sm btn-primary mr-1"
                      (click)="asignarPermisos(rol.iD_Rol)"
                    >
                      Asignar Permisos
                    </button>
                  </div>
                </td>
              </tr>
              <tr *ngIf="roles.length === 0">
                <td colspan="4" class="text-center">
                  No hay roles registrados
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  
</div>
